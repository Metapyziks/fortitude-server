<?
	if (session == null) {
		response.Redirect("/login.html");
		return;
	}

	Include("parts/functions.html");
	getPageStart("Activity", null, null);
	Include("parts/header.html");
	Include ("parts/sidebar.html"); 

	var events = DatabaseManager.Select<Event>(x => x.Type < EventType.Cache && x.ContextID == account.AccountID);
?>
		<div id = "content">
			<h1>View Activity Log</h1>
			<p>
				Here is what you've been up to.
			</p>
			<ul class = "news">
<?			
	foreach (var evt in events) 
	{
		switch(evt.Type)
		{
			case EventType.Register: 
				?><li>Account Created on: {$evt.TimeStamp} </li><?			
				break;
			case EventType.RankChange:
				var rank = (Rank) evt.AuxiliaryID;
				?><li>You were promoted to the rank of {$rank} on {$evt.TimeStamp} </li><?
				break;
			case EventType.PlaceCache:
				var cachesName = DatabaseManager.SelectFirst<Cache>(x => x.CacheID == evt.AuxiliaryID);
				?><li>You claimed the cache {$cachesName} </li><?
				break;
			case EventType.AttackCache:
				var theBattleReportThing =DatabaseManager.SelectFirst<BattleReport>(x => x.NotificationID == evt.AuxiliaryID);
				var thecachesName = DatabaseManager.SelectFirst<Cache>(x => x.CacheID == theBattleReportThing.CacheID);
				?><li>{$thecachesName} was attacked on {evt.TimeStamp}! </li><?
				break;
		}
	}
?>
			</ul>
		</div> <!-- content -->
		
		<? Include ("parts/footer.html"); ?>
