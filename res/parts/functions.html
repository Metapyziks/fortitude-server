<?
    // Determine whether to use the singular or plural form of a word.
	// @Params: singular form of the word, plural form, number of items.
    Func<String, String, int, String> pluralify = (singular, plural, count) =>
    {
        if (count == 1) {
            return singular;  
        } else {
            return plural;
        } 
    };
	
	// Get the page <head> up to the </title>.
    // @Params: page title, and two additional javascript sources (external library and internal code)
    // The javascript code to login is included by default.
	Action<String, String, String> getPageStart = (title, jsOne, jsTwo) =>
	{

		Echo ("<!DOCTYPE html>");
		Echo ("<html>");
		Echo ("<head>");
		Echo ("<title>");
		Echo ("Fortitude: " + title);
		Echo ("</title>");
		Echo ("<link rel=\"stylesheet\" type=\"text/css\" href=\"parts/stylesheet.css\">");
		Echo ("<script type=\"text/javascript\" src=\"http://crypto-js.googlecode.com/svn/tags/3.0.2/build/rollups/md5.js\"></script>");
        Echo ("<script type=\"text/javascript\" src=\"parts/scripts.js\"></script>");
		if (jsOne != null) {
			Echo ("<script type=\"text/javascript\" src=\"" + jsOne + "\"></script>");
		}
		
		if (jsTwo != null ) {
			Echo ("<script type=\"text/javascript\" src=\"" + jsTwo + "\"></script>");
		}
		Echo ("</head>");
	};

    Func<bool> isSignedIn = () =>
    {
        return session != null;
    };

    Func<Rank, bool> hasRank = (rank) =>
    {
        return isSignedIn() && (int) rank <= (int) session.Rank;
    };

    Func<bool> isVerified = () =>
    {
        return isSignedIn() && hasRank(Rank.Verified);
    };

    Func<bool> isAdmin = () =>
    {
        return isSignedIn() && hasRank(Rank.Admin);
    };

    Func<bool> isOwner = () =>
    {
        return isSignedIn() && hasRank(Rank.Owner);
    };
	
	/*
	Action<DateTime> calculateAge = (created) =>
	{
		var ts = new TimeSpan(DateTime.UtcNow.Ticks - created.Ticks);
		double delta = Math.Abs(ts.TotalSeconds);
		
		if (delta < 60) 
		{
			//return ts.Seconds == 1 ? "one second ago" : ts.Seconds
            //+ " seconds ago";
			Echo ("today");
		}
		else if (delta < 120) 
		{
			//return "a minute ago";
			Echo ("today");
		}
		else if (delta < 2700) // 45 * 60
		{
			//return ts.Minutes + " minutes ago";
			Echo ("today");
		}
		else if (delta < 5400) // 90 * 60
		{
			//return "an hour ago";
			Echo ("today");
		}
		else if (delta < 86400) 
		{ // 24 * 60 * 60
			//return ts.Hours + " hours ago";
			Echo ("today");
		}
		else if (delta < 172800) 
		{ // 48 * 60 * 60
			Echo ("yesterday");
		}
		else if (delta < 2592000) 
		{ // 30 * 24 * 60 * 60
			Echo (ts.Days + " days ago");
		}
		else if (delta < 31104000) 
		{ // 12 * 30 * 24 * 60 * 60
			int months = Convert.ToInt32(Math.Floor((double) ts.Days / 30));
			Echo (months <= 1 ? "one month ago" : months + " months ago");
		}
		else
		{
		int years = Convert.ToInt32(Math.Floor((double) ts.Days / 365));
		Echo (years <= 1 ? "one year ago" : years + " years ago");
		}
	};*/
?>
